<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruleta de Premios</title>

  <!-- üî• OPEN GRAPH PARA VISTA PREVIA -->
  <meta property="og:title" content="üé∞ Ruleta de Premios | FACU CASINO‚Ñ¢">
  <meta property="og:description" content="Gir√° la rueda y descubr√≠ tu premio.">
  <meta property="og:image" content="https://iili.io/KyPeQBS.md.jpg">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://facucasino.onrender.com">

  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: url('https://iili.io/KyL5Hba.md.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      text-align: center;
      overflow-x: hidden;
    }

    #logoPrincipal {
      width: 260px;
      margin: 20px auto 15px auto;
      display: block;
      filter: drop-shadow(0 0 12px #ff00ff);
    }

    h1 {
      font-size: 1.8rem;
      margin: 10px 0 20px 0;
      color: #ffcc00;
      text-shadow: 0 0 10px #ff00ff, 0 0 20px #00ffff;
      padding: 0 10px;
    }

    .wheel-container {
      position: relative;
      width: 320px;
      margin: 30px auto 0 auto;
    }

    .rgb-ring {
      position: absolute;
      top: -12px;
      left: -12px;
      width: 344px;
      height: 344px;
      border-radius: 50%;
      background: conic-gradient(#ff0000, #ff9900, #ffff00, #00ff00, #00ffff, #0066ff, #9900ff, #ff00ff, #ff0000);
      animation: rgbSpin 4s linear infinite;
      filter: blur(6px) brightness(1.8);
      z-index: -1;
    }

    @keyframes rgbSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #wheelCanvas {
      width: 100%;
      height: auto;
      border-radius: 50%;
    }

    .indicator {
      position: absolute;
      top: -35px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-top: 25px solid yellow;
      filter: drop-shadow(0 0 5px #ff0);
    }

    #spinButton {
      margin-top: 20px;
      background: #ff0000;
      color: #fff;
      font-size: 1.5rem;
      padding: 15px 40px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 0 20px #ff00ff, 0 0 40px #ff00ff;
      animation: neonPulse 1.5s infinite alternate;
    }

    #spinButton:disabled {
      background: gray;
      cursor: not-allowed;
      box-shadow: none;
      animation: none;
    }

    @keyframes neonPulse {
      from { box-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff; }
      to   { box-shadow: 0 0 20px #00ffff, 0 0 40px #00ffff; }
    }

    #popup {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    #popupContent {
      background: #222;
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      max-width: 90%;
      box-shadow: 0 0 20px #ffcc00;
      animation: popupIn 0.5s ease;
    }

    @keyframes popupIn {
      from { transform: scale(0.5); opacity: 0; }
      to   { transform: scale(1); opacity: 1; }
    }

    #popupContent h2 {
      font-size: 2rem;
      margin-bottom: 10px;
      color: #00ff99;
    }

    #popupContent p {
      margin: 10px 0;
      font-size: 1.2rem;
    }

    #solicitarBtn {
      margin-top: 15px;
      background: linear-gradient(45deg, #00ccff, #0066ff);
      color: #fff;
      font-size: 1.2rem;
      padding: 10px 20px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 15px #00ccff;
    }

    #closePopup {
      margin-top: 15px;
      background: #ff3333;
      color: #fff;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    #contactoFacu {
      margin-top: 15px;
      font-size: 1.1rem;
      color: #00ffea;
      text-shadow: 0 0 8px #00ffff;
      font-weight: bold;
    }

    #btnWhatsapp {
      margin-top: 10px;
      background: #25D366;
      color: #fff;
      border: none;
      font-size: 1.2rem;
      padding: 10px 25px;
      border-radius: 50px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 0 12px #25D366;
    }

    #btnWhatsapp img {
      width: 22px;
      height: 22px;
    }

    @media (max-width: 480px) {

      #logoPrincipal {
        width: 200px;
        margin-top: 15px;
      }

      h1 {
        font-size: 1.4rem;
        margin: 5px 0 15px 0;
      }

      .wheel-container {
        width: 250px;
      }

      .rgb-ring {
        width: 270px;
        height: 270px;
        top: -10px;
        left: -10px;
      }

      .indicator {
        top: -30px;
        border-left: 12px solid transparent;
        border-right: 12px solid transparent;
        border-top: 20px solid yellow;
      }

      #spinButton {
        font-size: 1.2rem;
        padding: 12px 30px;
      }

      #popupContent h2 {
        font-size: 1.6rem;
      }

      #popupContent p {
        font-size: 1rem;
      }

      #solicitarBtn,
      #closePopup,
      #btnWhatsapp {
        font-size: 1rem;
        padding: 10px 18px;
      }
    }
  </style>
</head>

<body>

  <img id="logoPrincipal" src="https://iili.io/KyPwhml.md.png" alt="Logo">

  <h1>üéâGir√° la rueda y descubr√≠ tu premioüéÅ</h1>

  <div class="wheel-container">
    <div class="rgb-ring"></div>
    <div class="indicator"></div>
    <canvas id="wheelCanvas" width="300" height="300"></canvas>
  </div>

  <button id="spinButton">GIRAR</button>

  <div id="popup">
    <div id="popupContent">
      <h2>¬°GANASTE! üéâ</h2>

      <p id="premioTexto"></p>
      <p id="extraTexto"></p>

      <button id="solicitarBtn">Solicitar premio</button>
      <br>
      <button id="closePopup">Cerrar</button>

      <p id="contactoFacu">üìû Contacto: 112512-8251 (Facu)</p>

      <button id="btnWhatsapp">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg">
        Contactar por WhatsApp
      </button>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <script>
    const premios = [
      "10% extra (en mi primera carga)",
      "15% extra (en mi primera carga)",
      "15% extra (en mi primera carga)",
      "20% extra (en mi segunda carga)",
      "100 fichas (sin carga, no retirables)",
      "300 fichas (sin carga, no retirables)",
      "300 fichas (sin carga, no retirables)"
    ];

    let lastSpinTime = localStorage.getItem("lastSpinTime");

    const canvas = document.getElementById("wheelCanvas");
    const ctx = canvas.getContext("2d");

    const spinButton = document.getElementById("spinButton");
    const popup = document.getElementById("popup");
    const premioTexto = document.getElementById("premioTexto");
    const extraTexto = document.getElementById("extraTexto");
    const solicitarBtn = document.getElementById("solicitarBtn");
    const closePopup = document.getElementById("closePopup");
    const btnWhatsapp = document.getElementById("btnWhatsapp");

    const sonidoGiro = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_15b88e99ff.mp3?filename=wheel-spin-1-110166.mp3");
    const sonidoDing = new Audio("https://cdn.pixabay.com/download/audio/2022/03/15/audio_5646dd24c8.mp3?filename=ding-126626.mp3");

    const numSegments = premios.length;
    const anglePerSegment = (2 * Math.PI) / numSegments;
    let currentAngle = 0;

    function drawWheel() {
      const colors = ["#ff0000","#ff9900","#ffff00","#00ff00","#00ccff","#0066ff","#9900ff"];
      for (let i = 0; i < numSegments; i++) {
        ctx.beginPath();
        ctx.moveTo(150,150);
        ctx.arc(150,150,150,i*anglePerSegment,(i+1)*anglePerSegment);
        ctx.fillStyle = colors[i % colors.length];
        ctx.fill();
        ctx.stroke();
      }
    }
    drawWheel();

    function getRemainingTime() {
      if (!lastSpinTime) return 0;
      const diff = Date.now() - parseInt(lastSpinTime);
      return 24*60*60*1000 - diff;
    }

    function showPopup(premio, countdownText = null) {

      if (!countdownText) {
        confetti({
          particleCount: 200,
          spread: 80,
          origin: { y: 0.6 }
        });
      }

      premioTexto.innerText = countdownText ? countdownText : `FELICIDADES üéâ Ganaste: ${premio}`;
      extraTexto.innerText = countdownText ? "" : "Record√° volver en 24 hs para volver a girar";

      popup.style.display = "flex";
      solicitarBtn.style.display = countdownText ? "none" : "inline-block";

      btnWhatsapp.onclick = () => {
        const url = `https://wa.me/541125127689`;
        window.open(url, "_blank");
      };

      if (!countdownText) {
        solicitarBtn.onclick = () => {
          const fecha = new Date().toLocaleString();
          const mensaje = `Hola, Facu. Gan√© en la rueda de premios: ${premio} (${fecha}) y quisiera solicitarlo. Gracias!`;
          const url = `https://wa.me/541125127689?text=${encodeURIComponent(mensaje)}`;
          window.open(url, "_blank");
        };
      }
    }

    function spinWheel() {
      let remaining = getRemainingTime();
      if (remaining > 0) {
        const horas = Math.floor(remaining / (1000*60*60));
        const mins = Math.floor((remaining % (1000*60*60)) / (1000*60));
        showPopup(null, `‚è≥ Podr√°s volver a girar en ${horas}h ${mins}m`);
        return;
      }

      spinButton.disabled = true;
      sonidoGiro.currentTime = 0;
      sonidoGiro.play();

      const spinTime = 4000;
      const spinAngle = Math.random()*360 + 1800;
      const startAngle = currentAngle;
      const targetAngle = startAngle + spinAngle;
      const startTime = performance.now();

      function animate(time) {
        let elapsed = time - startTime;

        if (elapsed < spinTime) {
          const progress = elapsed / spinTime;
          currentAngle = startAngle + (spinAngle * (1 - Math.pow(1 - progress, 3)));
          drawRotatedWheel(currentAngle);
          requestAnimationFrame(animate);
        } else {
          sonidoGiro.pause();
          sonidoGiro.currentTime = 0;
          sonidoDing.play();

          currentAngle = targetAngle;
          drawRotatedWheel(currentAngle);

          const degrees = currentAngle % 360;
          const index = Math.floor(degrees / (360/numSegments));
          const premio = premios[index];

          lastSpinTime = Date.now();
          localStorage.setItem("lastSpinTime", lastSpinTime);

          showPopup(premio);
          spinButton.disabled = false;
        }
      }
      requestAnimationFrame(animate);
    }

    function drawRotatedWheel(angle) {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.save();
      ctx.translate(150,150);
      ctx.rotate(angle * Math.PI / 180);
      ctx.translate(-150,-150);
      drawWheel();
      ctx.restore();
    }

    spinButton.addEventListener("click", spinWheel);
    closePopup.addEventListener("click", () => { popup.style.display = "none"; });
  </script>

</body>
</html>
